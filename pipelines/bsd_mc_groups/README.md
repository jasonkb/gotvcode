This code written by Fuzzy Weissmann and Jason Katz-Brown.
